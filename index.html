<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Notes App</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/three@0.169.0/build/three.module.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #1a1a1a; }
        #canvas { position: fixed; top: 0; left: 0; }
        #ui { position: absolute; top: 20px; left: 20px; z-index: 10; }
        .card { 
            background: rgba(255, 255, 255, 0.9); 
            border-radius: 12px; 
            padding: 20px; 
            transform: perspective(1000px) rotateX(5deg) rotateY(5deg); 
            transition: transform 0.3s; 
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); 
        }
        .card:hover { transform: perspective(1000px) rotateX(0deg) rotateY(0deg); }
        .saved-note { 
            background: rgba(255, 255, 255, 0.85); 
            border-radius: 8px; 
            padding: 15px; 
            margin-top: 10px; 
            transform: perspective(1000px) rotateX(3deg); 
            transition: transform 0.3s; 
        }
        .saved-note:hover { transform: perspective(1000px) rotateX(0deg); }
        input, textarea, button { 
            width: 100%; 
            padding: 10px; 
            margin-bottom: 10px; 
            border: 1px solid #ccc; 
            border-radius: 6px; 
            font-size: 16px; 
        }
        button { 
            background: #007bff; 
            color: white; 
            border: none; 
            cursor: pointer; 
        }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div id="canvas"></div>
    <div id="ui" class="max-w-md">
        <div class="card">
            <input id="title" type="text" placeholder="Title">
            <textarea id="text" placeholder="Your note..." rows="4"></textarea>
            <button id="save">Save</button>
        </div>
        <div id="saved" class="mt-4"></div>
    </div>
    <script type="module">
        import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.169.0/build/three.module.js';

        const supabase = Supabase.createClient(
            'https://fsosfgsmzdubqgjcpjug.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZzb3NmZ3NtemR1YnFnamNwanVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0NDQzMjEsImV4cCI6MjA2MTAyMDMyMX0.OFC9FFOkOso8Wa69hgYe9rDJKgii_FCM1RJN1oNHbqM'
        );

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas').appendChild(renderer.domElement);

        const geometry = new THREE.TorusKnotGeometry(2, 0.4, 100, 16);
        const material = new THREE.MeshStandardMaterial({ color: 0x007bff, wireframe: true });
        const torus = new THREE.Mesh(geometry, material);
        scene.add(torus);

        const light = new THREE.PointLight(0xffffff, 1, 100);
        light.position.set(10, 10, 10);
        scene.add(light);

        camera.position.z = 10;

        function animate() {
            requestAnimationFrame(animate);
            torus.rotation.x += 0.01;
            torus.rotation.y += 0.01;
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        const titleInput = document.getElementById('title');
        const textInput = document.getElementById('text');
        const saveButton = document.getElementById('save');
        const savedDiv = document.getElementById('saved');

        async function loadNotes() {
            const { data, error } = await supabase.from('notes').select('*');
            if (error) {
                console.error('Error loading notes:', error);
                return;
            }
            savedDiv.innerHTML = '';
            data.forEach(note => {
                const noteEl = document.createElement('div');
                noteEl.className = 'saved-note';
                noteEl.innerHTML = `<h3 class="font-bold">${note.title}</h3><p>${note.text}</p>`;
                savedDiv.appendChild(noteEl);
            });
        }

        saveButton.addEventListener('click', async () => {
            const title = titleInput.value.trim();
            const text = textInput.value.trim();
            if (title && text) {
                const { error } = await supabase.from('notes').insert([{ title, text }]);
                if (error) {
                    console.error('Error saving note:', error);
                } else {
                    titleInput.value = '';
                    textInput.value = '';
                    loadNotes();
                }
            }
        });

        loadNotes();
    </script>
</body>
</html>